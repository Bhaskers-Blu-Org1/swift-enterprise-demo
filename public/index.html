<html>
<head>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.1/angular.min.js" type="text/javascript"></script>
    <script src="vendor/angular-websocket.min.js"></script>
    <script src="js/homeController.js"></script>
    <script src="js/autoScalingController.js"></script>
    <script src="js/circuitBreakerController.js"></script>
    <script src="js/websocketFactory.js"></script>
    <script src="index.js"></script>
    
    <title>Swift Enterprise Demo</title>
</head>

<body ng-app="demoApp" ng-controller="homeController" ng-init="getInitData()">
    <div class="header">
        <div class="left container item">
            <div class="item swift-logo"><img class="bird" src="assets/colorless_bird.svg"></div>
            <div class="item title">Swift Enterprise Demo</div>
        </div>
        <div class="right container item">
            <a class="item dashboard-link" ng-href="{{dashboardLink}}" target="_blank">Metrics Dashboard</a>
        </div>
    </div>
    <div class="content">
        <span class="tab" ng-class="{'active-tab': displayedTab == 'autoScaling'}" ng-click="displayedTab = 'autoScaling'">Auto-Scaling Demo</span>
        <span class="tab" ng-class="{'active-tab': displayedTab == 'circuitBreaker'}" ng-click="displayedTab = 'circuitBreaker'">Circuit Breaker Demo</span>
        <hr class="top-line" />
        <div ng-controller="autoScalingController as asCtrl" ng-if="displayedTab == 'autoScaling'">
            <p>
                <fieldset>
                    <legend>Request Memory Usage</legend>
                    <br><div class="left container"><span class="item">Memory to use: </span><input type="range" id="memoryToUse" name="memoryToUse" class="item" min="0" max="{{memoryMax}}" step="{{memoryStep}}" ng-model="asCtrl.memoryValue" ng-mouseup="asCtrl.requestMemory(asCtrl.memoryValue)" /><span class="item"> {{asCtrl.displayMemoryValue(asCtrl.memoryValue, memoryUnit)}} {{memoryUnitLabel}}</span></div></br>
                    Status: <span id="memoryResponse">{{asCtrl.memoryMessage}}</span>
                </fieldset>
            </p>
            
            <p>
                <fieldset>
                    <legend>Set Response Time</legend>
                    <br><div class="left container"><span class="item">Delay requests by </span><input type="range" id="responseTime" name="responseTime" class="item" min="0" max="60" step="1" ng-model="asCtrl.responseTimeValue" ng-mouseup="asCtrl.setResponseDelay(asCtrl.responseTimeValue)" /><span class="item"> {{asCtrl.responseTimeValue}} seconds</span></div></br>
                    Status: <span id="responseTimeResponse">{{asCtrl.responseTimeMessage}}</span>
                </fieldset>
            </p>
            
            <p>
                <fieldset>
                    <legend>Request Throughput</legend>
                    <br><div class="left container"><span class="item">Number of requests: </span><input type="range" id="throughput" name="throughput" class="item" min="0" max="100" step="5" ng-model="asCtrl.throughputValue" ng-mouseup="asCtrl.requestThroughput(asCtrl.throughputValue)" /><span class="item"> {{asCtrl.throughputValue}} per second</span></div></br>
                    Status: <span id="throughputResponse">{{asCtrl.throughputMessage}}</span>
                </fieldset>
            </p>
        </div>
    
        <div ng-controller="circuitBreakerController as cbCtrl" ng-if="displayedTab == 'circuitBreaker'">
            <p>
                <fieldset>
                    <legend>Check Circuit</legend>
                    <br><button ng-click="cbCtrl.openCircuit()">Open the Circuit</button><button ng-click="cbCtrl.closeCircuit()">Close the Circuit</button><button ng-click="cbCtrl.invokeCircuit()">Invoke CircuitBreaker</button></br>
                    <br>Status: <span id="circuitResponse">{{cbCtrl.circuitMessage}}</span></br>
                    <br>Circuit is currently {{$parent.circuitState}}.</br>
                </fieldset>
            </p>
        </div>
    </div>
</body>
</html>
